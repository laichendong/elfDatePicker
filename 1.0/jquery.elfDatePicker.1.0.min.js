$(function(){$('<style>.f_l{float:left; _display:inline;} .f_r{float:right; _display:inline;} .clearfix:after {content:" "; display:block; clear:both; visibility:hidden; _line-height:0; height:0; } .clearfix {display: inline-block; } html[xmlns] .clearfix {display: block; }  .elfDatePicker{ 	width:13em; 	border: 1px solid #d2d2d2; 	border-radius: 3px; 	-moz-border-radius: 3px; 	-webkit-border-radius: 3px; 	box-shadow: 2px 2px 3px #eee; 	-moz-box-shadow: 2px 2px 3px #eee; 	-webkit-box-shadow: 2px 2px 3px #eee; 	padding:0.2em; 	background:#fcfcfc; 	background: -moz-linear-gradient(top, #fcfcfc, #fff); 	background: -webkit-gradient(linear, left top, left bottom, from(#fcfcfc), to(#fff) ); 	position:absolute; } .elfDatePicker *{ 	color:#333; } .elfDatePicker a{ 	text-decoration:none; } .elfDatePickerTitle,.elfDatePickerBottom{ 	display:block; } .elfDatePickerTitle,.elfDatePickerBottom,.elfDatePickerCalendar td{ 	border-radius: 3px; 	-moz-border-radius: 3px; 	-webkit-border-radius: 3px; 	background:#f9f9f9; 	background: -moz-linear-gradient(top, #f9f9f9, #f1f1f1); 	background: -webkit-gradient(linear, left top, left bottom, from(#f9f9f9), to(#f1f1f1) ); 	border: 1px solid #e6e6e6; } .elfDatePickerMonthWarp, .elfDatePickerYearWarp{ 	font-weight:600; 	font-size:0.9em; 	text-align:center; 	margin:3px; } .elfDatePickerMonth,.elfDatePickerYear{ 	padding:0 0.3em; 	height:1em; } .elfDatePickerTitlePrevMonth,.elfDatePickerTitleNextMonth,.elfDatePickerTitlePrevYear,.elfDatePickerTitleNextYear{ 	display:block; 	width:1em; 	height:1em; 	line-height:1em; } .elfDatePickerTitlePrevMonth,.elfDatePickerTitleNextMonth,.elfDatePickerTitlePrevYear,.elfDatePickerTitleNextYear,.elfDatePickerCalendar td.elfDatePickerCelToday,.elfDatePickerTodayBtn, .elfDatePickerClearBtn{ 	border: 1px solid #adb9c2; 	border-radius: 3px; 	-moz-border-radius: 3px; 	-webkit-border-radius: 3px; 	background:#eee; 	background: -moz-linear-gradient(top, #eee, #d2d2d2); 	background: -webkit-gradient(linear, left top, left bottom, from(#eee), to(#d2d2d2) ); } .elfDatePickerTitlePrevMonth:hover,.elfDatePickerTitleNextMonth:hover,.elfDatePickerTitlePrevYear:hover,.elfDatePickerTitleNextYear:hover,.elfDatePickerCalendar td.elfDatePickerCelHover,.elfDatePickerCalendar td.elfDatePickerCelChecked,.elfDatePickerTodayBtn:hover, .elfDatePickerClearBtn:hover{ 	background:#FDF595; 	background: -moz-linear-gradient(top, #FDF595, #FBDE4B); 	background: -webkit-gradient(linear, left top, left bottom, from(#FDF595), to(#FBDE4B) ); 	border: 1px solid #fdc367; 	color:#D0260F; } .elfDatePickerCalendar th{ 	font-weight:normal; } .elfDatePickerCalendar{ 	width:100%; } .elfDatePickerCalendar td{ 	cursor:pointer; 	width:1.3em; 	height:1em; 	line-height:1em; 	margin:0.3em; 	text-align:right; 	padding:0.2em; } .elfDatePickerCalendar td.elfDatePickerCelDisable{ 	background:#fff; 	background: -moz-linear-gradient(top, #fff, #f3f3f3); 	background: -webkit-gradient(linear, left top, left bottom, from(#fff), to(#f3f3f3) ); 	border: 1px solid #f1f1f1; 	color:#aaa; }  .elfDatePickerBottom{ 	margin-top:3px; } .elfDatePickerTodayBtn, .elfDatePickerClearBtn{ 	padding:2px 5px; 	margin:3px; 	height:1em; 	line-height:1em; }</style>').appendTo("head")});(function(A){A.fn.elfDatePicker=function(B){A.fn.elfDatePicker._options=A.extend(A.fn.elfDatePicker._options,B);return this.each(function(){var D="elfDatePicker"+new Date().getTime();A(this).data("dpUUID",D);var C=A.fn.elfDatePicker.build(A(this),A.fn.elfDatePicker.stringToDate(A(this).val()));A.fn.elfDatePicker.eventHandller(A(this),C);A(this).focus(function(){var E=A.fn.elfDatePicker.stringToDate(A(this).val());if(E){A.fn.elfDatePicker.rend(C,E.getFullYear(),E.getMonth(),E)}else{A.fn.elfDatePicker.rend(C,new Date().getFullYear(),new Date().getMonth())}A.fn.elfDatePicker.show(C)}).click(function(){return false})})};A.fn.elfDatePicker._options={monthLabel:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],weekLabel:["日","一","二","三","四","五","六"],afterPicked:function(){}};A.fn.elfDatePicker.build=function(C,E){var D=C.data("dpUUID");var B=A('<div class="elfDatePicker" style="display:none;" id="'+D+'"></div>').appendTo("body");if(E){B=A.fn.elfDatePicker.rend(B,E.getFullYear(),E.getMonth(),E)}else{B=A.fn.elfDatePicker.rend(B,new Date().getFullYear(),new Date().getMonth())}A.fn.elfDatePicker.setPosition(C,B);return B};A.fn.elfDatePicker.rend=function(J,N,L,K){J.empty();J.append('<div class="elfDatePickerTitle clearfix">	<div class="elfDatePickerMonthWarp f_l clearfix">		<a class="elfDatePickerTitlePrevMonth f_l" title="上月" href="javascript:void(0);">﹤</a>		<span class="elfDatePickerMonth f_l" value="'+L+'">'+A.fn.elfDatePicker._options.monthLabel[L]+'</span>		<a class="elfDatePickerTitleNextMonth f_l" title="下月" href="javascript:void(0);">﹥</a>	</div>	<div class="elfDatePickerYearWarp f_r clearfix">		<a class="elfDatePickerTitleNextYear f_r" title="明年" href="javascript:void(0);">﹥</a>		<span class="elfDatePickerYear f_r">'+N+'</span>		<a class="elfDatePickerTitlePrevYear f_r" title="去年" href="javascript:void(0);">﹤</a>	</div></div>');J.append('<table class="elfDatePickerCalendar"><thead>	<tr></tr></thead><tbody></tbody></table>');A.each(A.fn.elfDatePicker._options.weekLabel,function(Q,R){J.find(".elfDatePickerCalendar thead tr ").append('		<th><span title="星期'+this+'">'+this+"</span></th>")});var B=new Date(N,L,1);var P=A.fn.elfDatePicker.daysOfMonth(N,L);var F=new Date(N,L,P);var D="<tr>";for(var I=B.getDay();I>0;I--){var O=m=d="";var M;if(L==0){M=A.fn.elfDatePicker.daysOfMonth(N-1,11);O=(N-1)+"";m="12"}else{M=A.fn.elfDatePicker.daysOfMonth(N,L-1);O=N+"";m=L+"";if(L<10){m="0"+L}}d=(M-I+1)+"";var E=O+"-"+m+"-"+d;D+=('<td class="elfDatePickerCelDisable" date="'+E+'">'+d+"</td>")}for(var H=1;H<=P;H++){var O=m=d="";O=N+"";if(parseInt(L)<9){m="0"+(parseInt(L)+1)}else{m=(parseInt(L)+1)+""}if(H<10){d="0"+H}else{d=H+""}var E=O+"-"+m+"-"+d;D+=('<td date="'+E+'">'+H+"</td>");if(new Date(N,L,H).getDay()==6){D+=("</tr><tr>")}}var C=1;for(var G=F.getDay();G<6;G++){var O=m=d="";var M;if(parseInt(L)==11){O=(N+1)+"";m="01"}else{O=N+"";m=(parseInt(L)+2)+"";if(parseInt(L)<8){m="0"+(parseInt(L)+2)}}d="0"+C;var E=O+"-"+m+"-"+d;D+=('<td class="elfDatePickerCelDisable" date="'+E+'">'+C+"</td>");C++}D+=("</tr>");J.find(".elfDatePickerCalendar tbody").append(D);J.find(".elfDatePickerCalendar tbody td[date='"+A.fn.elfDatePicker.dateToString(new Date())+"']").addClass("elfDatePickerCelToday");if(K){J.find(".elfDatePickerCalendar tbody td[date='"+A.fn.elfDatePicker.dateToString(K)+"']").addClass("elfDatePickerCelChecked")}J.append('<div class="elfDatePickerBottom clearfix">	<a class="elfDatePickerTodayBtn f_l" href="javascript:void(0);" title="选择今天">今天</a>	<a class="elfDatePickerClearBtn f_r" href="javascript:void(0);" title="清除选择">清除</a></div>');return J};A.fn.elfDatePicker.eventHandller=function(C,B){var E="#"+B.attr("id");A(E+" .elfDatePickerCalendar td").live("mouseover",function(){A(this).addClass(E+" elfDatePickerCelHover")});A(E+" .elfDatePickerCalendar td").live("mouseout",function(){A(this).removeClass(E+" elfDatePickerCelHover")});A(E+" .elfDatePickerCalendar td").live("click",function(){A("td").removeClass(E+" elfDatePickerCelChecked");A(this).addClass(E+" elfDatePickerCelChecked");C.val(A(this).attr("date"));A.fn.elfDatePicker.hide(B);if(A.fn.elfDatePicker._options.afterPicked){A.fn.elfDatePicker._options.afterPicked()}});A(E+" .elfDatePickerTitlePrevMonth").live("click",function(){var G=A(E+" .elfDatePickerYear").text();var H=A(E+" .elfDatePickerMonth").attr("value");if(H==0){G--;H=11}else{H--}A(E+" .elfDatePickerYear").text(G);A(E+" .elfDatePickerMonth").attr("value",H).text(A.fn.elfDatePicker._options.monthLabel[H]);A.fn.elfDatePicker.rend(B,G,H)});A(E+" .elfDatePickerTitleNextMonth").live("click",function(){var G=A(E+" .elfDatePickerYear").text();var H=A(E+" .elfDatePickerMonth").attr("value");if(H==11){G++;H=0}else{H++}A(E+" .elfDatePickerYear").text(G);A(E+" .elfDatePickerMonth").attr("value",H).text(A.fn.elfDatePicker._options.monthLabel[H]);A.fn.elfDatePicker.rend(B,G,H)});A(E+" .elfDatePickerTitlePrevYear").live("click",function(){var G=A(E+" .elfDatePickerYear").text();var H=A(E+" .elfDatePickerMonth").attr("value");G--;A(E+" .elfDatePickerYear").text(G);A(E+" .elfDatePickerMonth").attr("value",H).text(A.fn.elfDatePicker._options.monthLabel[H]);A.fn.elfDatePicker.rend(B,G,H)});A(E+" .elfDatePickerTitleNextYear").live("click",function(){var G=A(E+" .elfDatePickerYear").text();var H=A(E+" .elfDatePickerMonth").attr("value");G++;A(E+" .elfDatePickerYear").text(G);A(E+" .elfDatePickerMonth").attr("value",H).text(A.fn.elfDatePicker._options.monthLabel[H]);A.fn.elfDatePicker.rend(B,G,H)});A(E+" .elfDatePickerTodayBtn").live("click",function(){C.val(A.fn.elfDatePicker.dateToString(new Date()));A.fn.elfDatePicker.hide(B)});A(E+" .elfDatePickerClearBtn").live("click",function(){C.val("");A.fn.elfDatePicker.hide(B)});function F(G,H){for(var I=0;I<H.length;I++){var J=H[I];if(G.x>=J.left&&G.x<=(J.left+J.width)&&G.y>=J.top&&G.y<=(J.top+J.height)){return true}}return false}var D=function(I){var G={x:I.pageX,y:I.pageY};var H=[];A.each(A(".elfDatePicker:visible"),function(){var J={left:A(this).offset().left,top:A(this).offset().top,width:A(this).outerWidth(),height:A(this).outerHeight()};H.push(J)});if(F(G,H)){return true}else{A(".elfDatePicker").hide(200);return false}};A("body").unbind("click",D).bind("click",D)};A.fn.elfDatePicker.show=function(B){B.css("position","absolute").show(200)};A.fn.elfDatePicker.hide=function(B){B.hide(200)};A.fn.elfDatePicker.setPosition=function(C,B){B.offset({left:C.offset().left,top:C.offset().top+C.outerHeight()})};A.fn.elfDatePicker.dateToString=function(B){var C=B.getFullYear();var D=B.getMonth()+1;if(D<10){D="0"+D}var B=B.getDate();if(B<10){B="0"+B}return C+"-"+D+"-"+B};A.fn.elfDatePicker.stringToDate=function(C){var B=C.match(/(\d{4})-(\d{2})-(\d{2})/);try{var E=A.fn.elfDatePicker.daysOfMonth(B[1],(B[2]-1));if(B[3]<=E){return new Date(B[1],(B[2]-1),B[3])}else{return new Date()}}catch(D){return new Date()}};A.fn.elfDatePicker.daysOfMonth=function(B,C){return new Date(B,C+1,0).getDate()};A.elfDatePicker=function(B){A(":text.dateInputer").elfDatePicker(B)}})(jQuery)